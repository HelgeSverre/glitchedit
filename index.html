<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>GĻƗŦÇĦɆĐƗŦ</title>

  <link rel="stylesheet" href="./style.css">

  <!-- Scripts -->
  <script src="https://cdn.jsdelivr.net/npm/fflate@0.8.2/umd/index.js"></script>
  <script type="module" src="./script.js"></script>
</head>
<body>
  <a href="#effects-panel" class="skip-link">Skip to effects</a>
  <a href="#hex-container" class="skip-link">Skip to editor</a>
  <div id="app">
    <!-- Header -->
    <header id="header">
      <div id="header-brand">
        <h1>GĻƗŦÇĦɆĐƗŦ</h1>
        <span class="version">v1.1.0</span>
        <a href="https://github.com/helgesverre/glitchedit" target="_blank" rel="noopener" class="github-link" aria-label="View on GitHub">
          <svg viewBox="0 0 16 16" width="16" height="16" fill="currentColor"><path d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0016 8c0-4.42-3.58-8-8-8z"/></svg>
        </a>
      </div>
      <div id="header-buttons">
        <button id="btn-load">Open</button>
        <button id="btn-random">Random image</button>
        <button id="btn-randomize-effects" disabled><span class="glitch-letter">G</span><span class="glitch-letter">l</span><span class="glitch-letter">i</span><span class="glitch-letter">t</span><span class="glitch-letter">c</span><span class="glitch-letter">h</span><span class="glitch-letter">!</span></button>
        <button id="btn-save" disabled>Download</button>
        <button id="btn-help">?</button>
      </div>
    </header>

    <!-- Main content -->
    <main id="main">
      <!-- Preview panel -->
      <div id="preview-panel">
        <div id="preview-container">
          <div id="dropzone" tabindex="0" role="button" aria-label="Drop zone: Drop PNG file here or press Enter to open file picker">
            <div id="dropzone-icon">PNG</div>
            <div>Drop PNG file here or click Load</div>
          </div>
          <canvas id="preview-canvas"></canvas>
          <div id="preview-error">
            <div>Invalid PNG</div>
            <div id="error-message"></div>
          </div>
          <div id="preview-loading">
            <div class="loading-spinner"></div>
            <div class="loading-text">Loading...</div>
          </div>
        </div>
      </div>

      <!-- Resizer -->
      <div id="resizer" tabindex="0" role="separator" aria-label="Resize preview panel"></div>

      <!-- Editor panel -->
      <div id="editor-panel">
        <!-- Chunk navigator -->
        <nav id="chunk-nav" aria-label="PNG chunks">
          <div id="chunk-nav-header">Chunks</div>
          <div id="chunk-list" role="listbox" aria-label="Chunk list"></div>
        </nav>

        <!-- Hex editor -->
        <div id="hex-container" tabindex="-1">
          <div id="hex-header">
            <span class="offset-col">Offset</span>
            <span class="hex-col">00 01 02 03 04 05 06 07 08 09 0A 0B 0C 0D 0E 0F</span>
            <span class="ascii-col">ASCII</span>
          </div>
          <div id="hex-scroll" tabindex="0" role="grid" aria-label="Hex editor">
            <div id="hex-content"></div>
          </div>
        </div>
      </div>

      <!-- Effects panel resizer -->
      <div id="resizer-effects" tabindex="0" role="separator" aria-label="Resize effects panel"></div>

      <!-- Effects panel -->
      <aside id="effects-panel" aria-label="Effects" tabindex="-1">
        <div id="effects-header">
          <span id="effects-header-title">Effects</span>
          <div id="effects-header-buttons">
            <button id="btn-add-effect" disabled aria-haspopup="listbox" aria-expanded="false">+ Add</button>
            <!-- Effect picker dropdown (uses CSS anchor positioning) -->
            <div id="effect-picker" role="listbox" aria-label="Available effects"></div>
          </div>
        </div>
        <div id="effects-content">
          <div id="layer-list" role="list" aria-label="Applied effects"></div>
        </div>
      </aside>
    </main>

    <!-- Status bar -->
    <footer id="status">
      <div class="status-item">
        <span class="status-label">File:</span>
        <span class="status-value" id="status-filename">-</span>
      </div>
      <div class="status-item">
        <span class="status-label">Size:</span>
        <span class="status-value" id="status-size">-</span>
      </div>
      <div class="status-item">
        <span class="status-label">Cursor:</span>
        <span class="status-value" id="status-cursor">-</span>
      </div>
      <div class="status-item">
        <span class="status-label">Selection:</span>
        <span class="status-value" id="status-selection">-</span>
      </div>
      <div class="status-item">
        <span class="status-indicator" id="status-valid"></span>
        <span class="status-value" id="status-valid-text">-</span>
      </div>
    </footer>

    <!-- Hidden file input -->
    <input type="file" id="file-input" accept=".png,image/png">

    <!-- Go to offset dialog -->
    <div id="edit-dialog">
      <div class="dialog-content">
        <div class="dialog-title" id="dialog-title">Go to Offset</div>
        <input type="text" class="dialog-input" id="dialog-input" placeholder="Enter hex offset (e.g., 0x100)">
        <div class="dialog-buttons">
          <button id="dialog-cancel">Cancel</button>
          <button id="dialog-ok">OK</button>
        </div>
      </div>
    </div>

    <!-- Help dialog -->
    <dialog id="help-dialog">
      <div class="help-header">
        <h2>Effects Guide</h2>
        <button id="help-close" aria-label="Close">&times;</button>
      </div>
      <div class="help-content"></div>
    </dialog>
  </div>


</body>
</html>
