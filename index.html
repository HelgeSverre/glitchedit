<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ĞŁİŦČĦƎĐİŦ</title>

  <link rel="stylesheet" href="./style.css">

  <!-- Scripts -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/pako/2.1.0/pako.min.js"></script>
  <script defer src="./script.js"></script>
</head>
<body>
  <a href="#effects-panel" class="skip-link">Skip to effects</a>
  <a href="#hex-container" class="skip-link">Skip to editor</a>
  <div id="app">
    <!-- Header -->
    <header id="header">
      <h1>ĞŁİŦČĦƎĐİŦ</h1>
      <div id="header-buttons">
        <button id="btn-load">Open PNG</button>
        <button id="btn-random">Random Image</button>
        <label class="mode-switch" title="Toggle between decoded pixel data and raw file bytes">
          <input type="checkbox" id="mode-toggle">
          <span class="mode-switch-slider"></span>
          <span class="mode-switch-label mode-switch-label-left">Pixel</span>
          <span class="mode-switch-label mode-switch-label-right">Raw</span>
        </label>
        <button id="btn-save" disabled>Export PNG</button>
        <button id="btn-save-raw" disabled>Save Raw</button>
      </div>
    </header>

    <!-- Main content -->
    <main id="main">
      <!-- Preview panel -->
      <div id="preview-panel">
        <div id="preview-container">
          <div id="dropzone" tabindex="0" role="button" aria-label="Drop zone: Drop PNG file here or press Enter to open file picker">
            <div id="dropzone-icon">PNG</div>
            <div>Drop PNG file here or click Load</div>
          </div>
          <canvas id="preview-canvas"></canvas>
          <div id="preview-error">
            <div>Invalid PNG</div>
            <div id="error-message"></div>
          </div>
          <div id="preview-loading">
            <div class="loading-spinner"></div>
            <div class="loading-text">Loading...</div>
          </div>
        </div>
      </div>

      <!-- Resizer -->
      <div id="resizer" tabindex="0" role="separator" aria-label="Resize preview panel"></div>

      <!-- Editor panel -->
      <div id="editor-panel">
        <!-- Chunk navigator -->
        <nav id="chunk-nav" aria-label="PNG chunks">
          <div id="chunk-nav-header">Chunks</div>
          <div id="chunk-list" role="listbox" aria-label="Chunk list"></div>
        </nav>

        <!-- Hex editor -->
        <div id="hex-container" tabindex="-1">
          <div id="hex-header">
            <span class="offset-col">Offset</span>
            <span class="hex-col">00 01 02 03 04 05 06 07 08 09 0A 0B 0C 0D 0E 0F</span>
            <span class="ascii-col">ASCII</span>
          </div>
          <div id="hex-scroll" tabindex="0" role="grid" aria-label="Hex editor">
            <div id="hex-content"></div>
          </div>
        </div>
      </div>

      <!-- Effects panel resizer -->
      <div id="resizer-effects" tabindex="0" role="separator" aria-label="Resize effects panel"></div>

      <!-- Effects panel -->
      <aside id="effects-panel" aria-label="Effects" tabindex="-1">
        <div id="effects-header">
          <span id="effects-header-title">Effects</span>
          <div id="effects-header-buttons">
            <button id="btn-add-effect" disabled aria-haspopup="listbox" aria-expanded="false">+ Add</button>
            <!-- Effect picker dropdown (uses CSS anchor positioning) -->
            <div id="effect-picker" role="listbox" aria-label="Available effects"></div>
          </div>
        </div>
        <div id="effects-content">
          <div id="layer-list" role="list" aria-label="Applied effects"></div>
        </div>
      </aside>
    </main>

    <!-- Status bar -->
    <footer id="status">
      <div class="status-item">
        <span class="status-label">File:</span>
        <span class="status-value" id="status-filename">-</span>
      </div>
      <div class="status-item">
        <span class="status-label">Size:</span>
        <span class="status-value" id="status-size">-</span>
      </div>
      <div class="status-item">
        <span class="status-label">Cursor:</span>
        <span class="status-value" id="status-cursor">-</span>
      </div>
      <div class="status-item">
        <span class="status-label">Selection:</span>
        <span class="status-value" id="status-selection">-</span>
      </div>
      <div class="status-item">
        <span class="status-indicator" id="status-valid"></span>
        <span class="status-value" id="status-valid-text">-</span>
      </div>
      <div class="status-item">
        <span class="status-label">Mode:</span>
        <span class="status-value" id="status-mode">-</span>
      </div>
    </footer>

    <!-- Hidden file input -->
    <input type="file" id="file-input" accept=".png,image/png">

    <!-- Go to offset dialog -->
    <div id="edit-dialog">
      <div class="dialog-content">
        <div class="dialog-title" id="dialog-title">Go to Offset</div>
        <input type="text" class="dialog-input" id="dialog-input" placeholder="Enter hex offset (e.g., 0x100)">
        <div class="dialog-buttons">
          <button id="dialog-cancel">Cancel</button>
          <button id="dialog-ok">OK</button>
        </div>
      </div>
    </div>
  </div>


</body>
</html>
